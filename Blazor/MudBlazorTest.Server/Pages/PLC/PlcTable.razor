@page "/testPlc"
@using FluentValidation
@using System.ComponentModel.DataAnnotations
@using System.Net.Http.Json
@using Newtonsoft.Json
@using MudBlazorTest.Server.Services
@using MudBlazorTest.Server.Services.Base
@using MudBlazor.Services
@using System.Reflection;

@inject IMicrologixPlcService plcService

@*inject ISnackbar _snackbar*@

<style type="text/css">
    .mud-table-head .header-centered th {
        text-align: center;
        font-size: 1.2em;
    }

    .mud-table-foot .bold-text .mud-table-cell {
        font-weight: 500;
    }

    .table-options {
        margin: 15px;
        outline: solid;
    }
</style>


@*// TODO: Make the table min content width*@


<MudGrid Spacing="3" Justify="Justify.Center">
    <MudItem xs="12">
        <MudTable Items="@_localPlcList" @ref="_plcTable" Dense="true" Hover="true" Striped="true"
                  Bordered="true" Elevation="4" FixedHeader="true" FixedFooter="true" Loading="@_loading"
                  CustomFooter="true" RowsPerPage="10" Breakpoint="Breakpoint.Xs"
                  SelectedItemChanged="OnSelectedItemChanged"
                  RowClassFunc="@SelectedRowClassFunc" OnRowClick="OnRowClickEvent" T="LocalPlc">
            <ToolBarContent>
                <MudText Typo="Typo.h6">Micrologix PLCs </MudText>
                <MudSpacer />
                <MudTextField @bind-Value="_searchString" Placeholder="Search"
                              Adornment="Adornment.Start"
                              AdornmentIcon="@Icons.Material.Filled.Search" IconSize="Size.Medium"
                              Class=""></MudTextField>
            </ToolBarContent>
            <HeaderContent>

                <MudTh>Name</MudTh>
                <MudTh>Id</MudTh>
                <MudTh>Gateway</MudTh>
                <MudTh>PlcType</MudTh>
                <MudTh>Protocol</MudTh>

            </HeaderContent>
            <RowTemplate>
                <MudTd DataLabel="Name">@context!.Name</MudTd>
                <MudTd DataLabel="Id">@context!.Id</MudTd>
                @*<MudTd DataLabel="Details">@context.Details</MudTd>*@
                <MudTd DataLabel="Gateway">@context!.Gateway</MudTd>
                <MudTd DataLabel="PlcType">@context!.PlcType</MudTd>
                <MudTd DataLabel="Protocol">@context!.Protocol</MudTd>
            </RowTemplate>
            <FooterContent>
                @* for each tag in context.PlcTags, add a row to the footer
                for each tag attribute, make a column and show the value
                *@

                <MudTFootRow class="">
                    <MudTd colspan="5" Class="">
                        colspan: 5
                    </MudTd>
                </MudTFootRow>
                <MudTFootRow>
                    <MudTd colspan="5">

                        <MudGrid Justify="Justify.Center">

                            @foreach (var tag in _plcTagList)
                            {
                                <MudItem xs="4">
                                    <MudCard Elevation="4">
                                        <MudCardHeader>
                                            <MudText Typo="Typo.h6">@(tag.CustomName != null ? tag.CustomName : tag.RslinxTagName)</MudText>
                                            </MudCardHeader>
                                            <MudCardContent>
                                                <MudText Typo="Typo.h6">@tag.Id</MudText>
                                                <MudText Typo="Typo.body1">@tag.TagType</MudText>
                                            </MudCardContent>
                                        </MudCard>
                                    </MudItem>
                            }
                        </MudGrid>
                    </MudTd>
                </MudTFootRow>

            </FooterContent>
            <PagerContent>
                <MudTablePager />
            </PagerContent>
        </MudTable>

    </MudItem>

    @* for each item in _plcTagList, create a card to display the Tag *@


</MudGrid>



@*<div class="table-options">*@
<MudSwitch @bind-Checked="_ronly">Edit</MudSwitch>
@*</div>*@





